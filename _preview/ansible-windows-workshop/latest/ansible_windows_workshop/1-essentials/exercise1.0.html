<!DOCTYPE html>
<!--[if IE 8]> <html class="ie8"> <![endif]-->
<!--[if IE 9]> <html class="ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html>
<!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Ansible Windows Workshop latest | Ansible Windows Exercises | 1 - Essentials | Exercise 1.0</title>
  <link href="https://assets.openshift.net/content/subdomain.css" rel="stylesheet" type="text/css">
  <link href="../../../latest/_stylesheets/docs.css" rel="stylesheet" />
  <link href="https://www.ansible.com/hs-fs/hub/330046/file-448313641-png/favicon.png" rel="apple-touch-icon-precomposed" type="image/png">
  <link href="https://www.ansible.com/hs-fs/hub/330046/file-448313641-png/favicon.png" rel="shortcut icon" type="text/css">
  <!--[if IE]><link rel="shortcut icon" href="https://www.ansible.com/hs-fs/hub/330046/file-448313641-png/favicon.png"><![endif]-->
  <!-- or, set /favicon.ico for IE10 win -->
  <meta content="OpenShift" name="application-name">
  <meta content="#000000" name="msapplication-TileColor">
  <meta content="https://www.ansible.com/hs-fs/hub/330046/file-448313641-png/favicon.png" name="msapplication-TileImage">
  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <script src="https://assets.openshift.net/content/html5shiv.js" type="text/javascript"></script>
    <script src="https://assets.openshift.net/content/respond.js" type="text/javascript"></script>
    <link href="https://assets.openshift.net/content/vendor/respond-js/respond-proxy.html" id="respond-proxy" rel="respond-proxy">
    <link href="../../../latest/_images/respond.proxy.gif" id="respond-redirect" rel="respond-redirect">
    <script src="../../../latest/_javascripts/respond.proxy.js" type="text/javascript"></script>
  <![endif]-->
  <script src="https://assets.openshift.net/content/modernizr.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/subdomain.js" type="text/javascript"></script>
  <script src="../../../latest/_javascripts/bootstrap-offcanvas.js" type="text/javascript"></script>
  <script type="text/javascript" src="https://assets.openshift.net/app/assets/site/tracking.js"></script>
</head>
<body>
  <div class="navbar navbar-default navbar-openshift" role="navigation">
  <div class="navbar-header">
    <div class="dropdown">
      <a href="#" class="dropdown-toggle navbar-menu-toggle" data-toggle="dropdown">
        <span class="navbar-menu-title">MENU</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <ul class="dropdown-menu navbar-menu" role="menu">
        <li class="submenu">
          <a href="#">Overview</a>
          <ul id="submenu-overview" class="dropdown-submenu">
            <li class="submenu-heading">Ansible Workshop</li>
            <li>
                What is Ansible Tower?
                <span class="submenu-item-desc">Extend the power of Ansible to your entire team. Ansible Tower by Red Hat helps you scale IT automation, manage complex deployments and speed productivity. Centralize and control your IT infrastructure with a visual dashboard, role-based access control, job scheduling and graphical inventory management.</span>
              </a>
            </li>
            <li class="submenu-heading">Links</li>
            <li>
              <a href="https://www.ansible.com/tower">
                Ansible Tower
                <span class="submenu-item-desc">Learn more about Ansible Tower.</span>
              </a>
            </li>
            <li>
              <a href="https://www.ansible.com/">
                Ansible
                <span class="submenu-item-desc">Ansible seamlessly unites workflow orchestration with configuration management, provisioning, and application deployment in one easy-to-use and deploy platform.</span>
              </a>
            </li>
            <li>
              <a href="https://galaxy.ansible.com/">
                Ansible Galaxy
                <span class="submenu-item-desc">Jump-start your automation project with great content from the Ansible community. Galaxy provides pre-packaged units of work known to Ansible as roles. Roles can be dropped into Ansible PlayBooks and immediately put to work. You'll find roles for provisioning infrastructure, deploying applications, and all of the tasks you do everyday.</span>
              </a>
            </li>
          </ul>
        </li>
        <li class="submenu">
          <a href="#">Connect</a>
          <ul id="submenu-connect" class="dropdown-submenu">
            <li>
              <a href="https://access.redhat.com/downloads/">
                Downloads <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://www.facebook.com/ansibleautomation/">
                Facebook <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://www.linkedin.com/company/red-hat">
                LinkedIn <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://plus.google.com/+RedHat">
                Google+ <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
            <li>
              <a href="https://www.youtube.com/user/RedHatVideos">
                YouTube <i class="fa fa-external-link pull-right"></i>
              </a>
            </li>
          </ul>
        </li>
      <li class="submenu">
        <a href="#">Contact Us</a>
        <ul id="submenu-connect" class="dropdown-submenu">
          <li>
             <a href="https://www.redhat.com/en/about/contact#na">
             Contact Us
             </a>
          </li>
        </ul>
    </div>
    <a class="navbar-brand red-hat-public-sector" href="/"></a>
  </div>
  <!-- <div class="navbar-collapse collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="hidden-xs dropdown"> <a href="#" class="dropdown-toggle nav-log-in" data-toggle="dropdown"> My Account<span class="caret"></span> </a>
        <ul class="dropdown-menu">
          <li><a href="https://openshift.redhat.com/app/console">OpenShift Web Console</a></li>
          <li><a href="https://console.preview.openshift.com/">(Next Gen) Web Console</a></li>
          <li><a href="https://hub.openshift.com/users/auth/github">OpenShift Hub</a></li>
        </ul>
      </li>
      <li class="hidden-xs hidden-sm"><a class="nav-sign-up" href="https://www.openshift.com/devpreview/register.html">Sign up for Free</a></li>
    </ul>
  </div> -->
</div>
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a href="../../../index.html">Workshops</a>
      </li>
      <li class="hidden-xs active">
        Ansible Windows Workshop latest
      </li>
      <li class="hidden-xs active">
        Ansible Windows Exercises
      </li>
      <li class="hidden-xs active"><a href="../../ansible_windows_workshop/1-essentials/exercise1.0.html">1 - Essentials</a></li>
      <li class="hidden-xs active">
        Exercise 1.0
      </li>
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <div class="row-fluid">
          
<script>
  (function() {
    var cx = '013769182564158614814:e-dp46b51vk';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

        </div>
        <ul class="nav nav-sidebar">
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-down"></span>Ansible Windows Exercises
      </a>
      <ul id="topicGroup0" class="collapse in list-unstyled">
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-0-0">
                <span id="sgSpan-0-0" class="fa fa-caret-right"></span>&nbsp;Welcome
              </a>
              <ul id="topicSubGroup-0-0" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../../ansible_windows_workshop/0-setup/index.html">Agenda</a></li>

                  <li><a class="" href="../../ansible_windows_workshop/0-setup/setup.html">Workshop Lab Setup</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-0-1">
                <span id="sgSpan-0-1" class="fa fa-caret-down"></span>&nbsp;1 - Essentials
              </a>
              <ul id="topicSubGroup-0-1" class="nav-tertiary list-unstyled collapse in">

                  <li><a class=" active" href="../../ansible_windows_workshop/1-essentials/exercise1.0.html">Exercise 1.0</a></li>

                  <li><a class="" href="../../ansible_windows_workshop/1-essentials/exercise1.1.html">Exercise 1.1</a></li>

                  <li><a class="" href="../../ansible_windows_workshop/1-essentials/exercise1.2.html">Exercise 1.2</a></li>

                  <li><a class="" href="../../ansible_windows_workshop/1-essentials/exercise1.3.html">Exercise 1.3</a></li>

                  <li><a class="" href="../../ansible_windows_workshop/1-essentials/exercise1.4.html">Exercise 1.4</a></li>

                  <li><a class="" href="../../ansible_windows_workshop/1-essentials/exercise1.5.html">Exercise 1.5</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-0-2">
                <span id="sgSpan-0-2" class="fa fa-caret-right"></span>&nbsp;2 - Tower
              </a>
              <ul id="topicSubGroup-0-2" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../../ansible_windows_workshop/2-tower/exercise2.0.html">Exercise 2.0</a></li>

                  <li><a class="" href="../../ansible_windows_workshop/2-tower/exercise2.1.html">Exercise 2.1</a></li>

                  <li><a class="" href="../../ansible_windows_workshop/2-tower/exercise2.2.html">Exercise 2.2</a></li>

                  <li><a class="" href="../../ansible_windows_workshop/2-tower/exercise2.3.html">Exercise 2.3</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-0-3">
                <span id="sgSpan-0-3" class="fa fa-caret-right"></span>&nbsp;Wrap Up
              </a>
              <ul id="topicSubGroup-0-3" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../../ansible_windows_workshop/0-setup/wrapup.html">Wrap-up</a></li>
              </ul>
            </li>
      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h2>Exercise 1.0 - Running Ad-hoc commands</h2>
        </div>
        <div class="sect1">
<h2 id="section-1-ad-hoc-commands"><a class="anchor" href="#section-1-ad-hoc-commands"></a>Section 1: Ad-hoc commands</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For our first exercise, we are going to run some ad-hoc commands to help you get
a feel for how Ansible works.  Ansible Ad-Hoc commands enable you to perform tasks
on remote nodes without having to write a playbook.  They are very useful when you
simply need to do one or two things quickly and often, to many remote nodes.</p>
</div>
<div class="sect2">
<h3 id="step-0"><a class="anchor" href="#step-0"></a>Step 0:</h3>
<div class="paragraph">
<p>SSH into your Tower host and define your inventory.  Inventories are crucial to Ansible as they define remote machines on which you wish to run
commands or your playbook(s).  For this workshop we have already created a base inventory file to save you the effort.  Use <code>cat ~/lightbulb/lessons/lab_inventory/student#-instances.txt</code> to view the file.  Notice there is a section of vars to be assigned to particular groups.  Then there are individual hosts within groups including authentication details.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
At this point we are just using basic authentication to a local Administrator.  Also, the password is clear text in the inventory.  Later in this workshop we will show how to use AD authentication and securely store credentials.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-1"><a class="anchor" href="#step-1"></a>Step 1:</h3>
<div class="paragraph">
<p>Let&#8217;s start with something really basic - pinging a host.  The <code>win_ping</code> module makes sure our windows hosts are responsive.  This is not a traditional 'ping', but actually verifying connectivity to the host.</p>
</div>
<div class="paragraph">
<p>Ansible uses WinRM to interact with Windows hosts.  This has already been setup in our lab.  However, in other environments a script to enable this is provided here: (<a href="https://github.com/ansible/ansible/blob/devel/examples/scripts/ConfigureRemotingForAnsible.ps1" class="bare">https://github.com/ansible/ansible/blob/devel/examples/scripts/ConfigureRemotingForAnsible.ps1</a>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ansible windows -m win_ping</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-2"><a class="anchor" href="#step-2"></a>Step 2:</h3>
<div class="paragraph">
<p>Now let&#8217;s see how we can run a PowerShell command and view the output using the <code>win_shell</code> module.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ansible windows -m win_shell -a &quot;Get-Service&quot;
ansible windows -m win_shell -a &quot;Get-Process&quot;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-3"><a class="anchor" href="#step-3"></a>Step 3:</h3>
<div class="paragraph">
<p>Take a look at your windows nodes configuration.  The <code>setup</code> module displays ansible facts (and a lot of them) about an endpoint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ansible windows -m setup</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-4"><a class="anchor" href="#step-4"></a>Step 4:</h3>
<div class="paragraph">
<p>Now, let&#8217;s install IIS using the <code>win_feature</code> module. It may take a moment to complete.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ansible windows -m win_feature -a &quot;name=Web-Server state=present&quot;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-5"><a class="anchor" href="#step-5"></a>Step 5:</h3>
<div class="paragraph">
<p>OK, IIS is installed now so let&#8217;s be certain it is started using the <code>service</code> module.  Test connectivity with curl to see a base IIS page (Make certain to replace # with your user number).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ansible windows -m win_service -a &quot;name=W3Svc state=started&quot;
curl http://student#-node1/</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-6"><a class="anchor" href="#step-6"></a>Step 6:</h3>
<div class="paragraph">
<p>Finally, let&#8217;s clean up after ourselves.  First, stop the httpd service.  You can verify again the the curl just hangs.  (ctrl-c to break out of the command)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ansible windows -m win_service -a &quot;name=W3Svc state=stopped&quot;
curl http://student#-node1/</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="step-7"><a class="anchor" href="#step-7"></a>Step 7:</h3>
<div class="paragraph">
<p>Next, remove the IIS feature and reboot.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">ansible windows -m win_feature -a &quot;name=Web-Server state=absent&quot;
ansible windows -m win_reboot</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can run <strong>win_ping</strong> module as you did earlier to verify the systems are back online.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Like many Linux commands, <code>ansible</code> allows for long-form options as well as short-form.  For example:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>ansible windows --module-name win_ping</pre>
</div>
</div>
<div class="paragraph">
<p>is the same as running</p>
</div>
<div class="listingblock">
<div class="content">
<pre>ansible windows -m win_ping</pre>
</div>
</div>
<div class="paragraph">
<p>We are going to be using the short-form options throughout this workshop</p>
</div>
</div>
</div>
</div>
</div>
</div>
      </div>
    </div>
  </div>
  <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
    });
    /*]]>*/
  </script>
    <footer class="footer-openshift">
  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-sm-4 col-md-3 logo">
        <a href="https://www.redhat.com/"></a>
      </div>
      <div class="col-xs-12 col-sm-4 col-md-6 text-center">
        <div class="row">
          <div class="col-xs-12 col-md-4">
            <a href="https://www.redhat.com/en/about/privacy-policy">
              Privacy Policy
            </a>
          </div>
          <div class="col-xs-12 col-md-4">
          <a href="https://www.redhat.com/en/about/terms-use">
            Terms and Conditions
          </a>
          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-4 col-md-3 text-right">
        <a id="built_with_asciibinder" href="http://asciibinder.org/">
          <img src="../../../latest/_images/asciibinder_web_logo.svg" alt="AsciiBinder" />
        </a>
      </div>
    </div>
  </div>
</footer>
</body>
</html>